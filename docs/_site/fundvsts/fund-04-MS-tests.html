<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width">

        <title>PartsUnlimitedMRP : Testing with VSTS and Eclipse</title>
        <meta name="description" content="DevOps Hands On Labs">

        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="/PartsUnlimitedMRP/css/syntax.css">
        <link rel="stylesheet" href="/PartsUnlimitedMRP/css/main.css">
    </head>
    <body>

        <div class="container">
            <div class="row">
                <div id="header" class="col-sm-12">
                    <img class="logo" src="http://julienstroheker.github.io/PartsUnlimitedMRP/assets/logo-ms-dark.png" alt="Microsoft">
<h4><a class="brand" href="/PartsUnlimitedMRP/">PartsUnlimitedMRP</a>
    <small>DevOps Hands On Labs</small>
</h4>

                </div>
            </div>

            <div class="row">
                
                
                    <div id="navigation" class="col-sm-3">
                        <ul class="nav nav-list">
    
        <li><a href="/PartsUnlimitedMRP/">Welcome</a></li>
    

    
        
        

        
            
                <li class="nav-header">Fundamentals using Visual Studio Team Services</li>
            

            
                <li data-order="7"><a href="/PartsUnlimitedMRP/fundvsts/fund-05-MS-LoadTest.html">Auto-Scale & Load Tests</a></li>
            
        
            

            
                <li data-order="6"><a class="nav-active" href="/PartsUnlimitedMRP/fundvsts/fund-04-MS-tests.html">Testing with VSTS and Eclipse</a></li>  
            
        
            

            
                <li data-order="5"><a href="/PartsUnlimitedMRP/fundvsts/fund-03-MS-APM.html">Application Performance Monitoring</a></li>
            
        
            

            
                <li data-order="4"><a href="/PartsUnlimitedMRP/fundvsts/fund-02-MS-CDAgent.html">Continuous Deployment with Remote Agent</a></li>
            
        
            

            
                <li data-order="3"><a href="/PartsUnlimitedMRP/fundvsts/fund-02-MS-CD.html">Continuous Deployment with Hosted agent</a></li>
            
        
            

            
                <li data-order="2"><a href="/PartsUnlimitedMRP/fundvsts/fund-01-MS-CI.html">Continuous Integration</a></li>
            
        
            

            
                <li data-order="1"><a href="/PartsUnlimitedMRP/fundvsts/fund-0-MS-prereq.html">Set up Parts Unlimited MRP</a></li>
            
        
    
        
        

        
            
                <li class="nav-header">Fundamentals using Other Tools</li>
            

            
                <li data-order="5"><a href="/PartsUnlimitedMRP/fundoth/fund-14-Oth-chef.html">Continuous Deployment with Chef</a></li>
            
        
            

            
                <li data-order="4"><a href="/PartsUnlimitedMRP/fundoth/fund-13-Oth-puppet.html">Continuous Deployment with Puppet</a></li>
            
        
            

            
                <li data-order="3"><a href="/PartsUnlimitedMRP/fundoth/fund-12-Oth-CD.html">Continuous Deployment with Jenkins</a></li>
            
        
            

            
                <li data-order="2"><a href="/PartsUnlimitedMRP/fundoth/fund-11-Oth-CI.html">Continuous Integration with Jenkins</a></li>
            
        
            

            
                <li data-order="1"><a href="/PartsUnlimitedMRP/fundoth/fund-10-Oth-prereq.html">Set up Parts Unlimited MRP</a></li>
            
        
    
        
        

        
    
        
        

        
            
                <li class="nav-header">Advanced</li>
            

            
                <li data-order="1"><a href="/PartsUnlimitedMRP/adv/adv-21-Docker.html">Microservices with Docker</a></li>
            
        
    
<!-- List additional links. It is recommended to add a divider
    e.g. <li class="divider"></li> first to break up the content. -->
</ul>

                    </div>

                    <div id="content" class="col-sm-9">
                        <div class="page-header">
    <h2>Testing with VSTS and Eclipse
        
    </h2>
</div>

<h3 id="parts-unlimited-mrp-app-automated-testing-with-vsts-build-using-the-eclipse-ide">Parts Unlimited MRP App Automated Testing with VSTS Build using the Eclipse IDE</h3>

<p>In this lab, you will learn how to create new JUnit tests to the Parts Unlimited MRP App using the Eclipse IDE, and then get them to run in an automated build in Visual Studio Team Services. After finishing this lab, you will have added unit tests to the Parts Unlimited MRP App and have those tests running during build time.</p>

<h3 id="pre-requisites">Pre-requisites</h3>

<ul>
  <li>An active Visual Studio Team Services account</li>
  <li>Eclipse (<a href="http://www.eclipse.org/" title="http://www.eclipse.org/">http://www.eclipse.org/</a>)</li>
  <li>Completion of the <a href="https://github.com/Microsoft/PartsUnlimitedMRP/tree/master/docs/HOL_Continuous-Integration">Continuous Integration HOL</a></li>
</ul>

<h3 id="tasks-overview">Tasks Overview</h3>

<p><strong>Set up the development environment:</strong> This step will get your local environment set up to work on the Parts Unlimited MRP App.</p>

<p><strong>Add JUnit tests to the Parts Unlimited MRP App:</strong> In this step, you will add automated unit tests to the Parts Unlimited MRP App and run them locally.</p>

<p><strong>Run the automated tests in an automated build:</strong> In this step, you will run the JUnit tests as part of the Continuous Integration Build that was set up in the  Continuous Integration HOL with Parts Unlimited MRP.</p>

<h3 id="set-up-the-development-environment">1. Set up the development environment</h3>

<p>First, we need to set up Eclipse in order to work on the Parts Unlimited MRP App on our local machine. The Parts Unlimited MRP App uses <a href="https://gradle.org/">Gradle</a>, so we need to set up the code as Gradle projects in Eclipse.</p>

<p><strong>1.</strong> Open up <strong>Eclipse</strong>.</p>

<p><strong>2.</strong> Navigate to the application toolbar and select <code class="highlighter-rouge">Help -&gt; Eclipse Marketplace</code>. Search for the <a href="https://projects.eclipse.org/projects/tools.buildship">Gradle Buildship plugin</a>. If the plugin is not installed already, install it and restart Eclipse. If the plugin is installed already, click on the <strong>Installed</strong> tab and select <strong>Update</strong> on the plugin if possible.</p>

<p><img src="../assets/test/find_buildship_plugin.png" alt="" /></p>

<p><strong>3.</strong> From the menu of Eclipse, select <strong>Window -&gt; Perspective -&gt; Open Perspective -&gt; Other…</strong> to select the perspective that we want.</p>

<p><img src="../assets/test/open_other_perspective.png" alt="" /></p>

<p><strong>6.</strong> Select <strong>Git</strong> and click <strong>OK</strong>.</p>

<p><img src="../assets/test/git_perspective.png" alt="" /></p>

<p>This will open up the Git perspective in Eclipse.</p>

<p><strong>7.</strong> If the Visual Studio Team Services Git repository already exists on your local machine, <strong>skip to step 8</strong>. Otherwise, click the <strong>Clone a Git repository</strong> from the Git Repositories Window:</p>

<p><img src="../assets/test/clone_repo.png" alt="" /></p>

<p>In the Clone Git Repository, <strong>paste the URL for your Visual Studio Team Services Git repo</strong> into the URI text field, <strong>enter your alternate credentials</strong> in the Authentication section , and click <strong>Next</strong>.</p>

<blockquote>
  <p><a href="https://www.visualstudio.com/en-us/docs/integrate/get-started/auth/overview">Click here to setup your alternate credentials in your Visual Studio Team Services subscription</a></p>
</blockquote>

<p><img src="../assets/test/repo_uri.png" alt="" /></p>

<p>Select any branch that you want, and click <strong>Next</strong>.</p>

<p><img src="../assets/test/select_branches.png" alt="" /></p>

<p>On the next page, leave the defaults and click <strong>Finish</strong>.</p>

<p><img src="../assets/test/repo_clone_finish.png" alt="" /></p>

<p>This will clone the repository to your local machine. You should be able to see the repository in the Git Repositories window.</p>

<p><img src="../assets/test/local_repo.png" alt="" /></p>

<p><strong>8.</strong> If you already have the Visual Studio Team Services Git repo on your machine, select the option to <strong>Add an existing local Git repository</strong>, then navigate to the folder of the Git repo and check the box next to it to add the repo reference into Eclipse.</p>

<p><img src="../assets/test/add_existing_git_repo.png" alt="" /></p>

<p><strong>9.</strong> Open the <strong>Java perspective</strong> by clicking the shortcut in the top right corner of Eclipse.</p>

<p><img src="../assets/test/java_perspective.png" alt="" /></p>

<p><strong>12.</strong> In the top left, click the <strong>New</strong> drop down and select <strong>Java project</strong>.</p>

<p><img src="../assets/test/new_java_project.png" alt="" /></p>

<p><strong>13.</strong> In the New Java Project dialog name the project <strong>IntegrationService</strong>, uncheck the <strong>Use default location</strong>, choose the <strong>IntegrationService</strong> folder located in <code class="highlighter-rouge">src/Backend/</code> of the PartsUnlimitedMRP repository, and click <strong>Finish</strong>.</p>

<p><img src="../assets/test/new_integration_service.png" alt="" /></p>

<p><strong>14.</strong> In the Package Explorer window, <strong>right-click on IntegrationService</strong> and then select <strong>Configure -&gt; Add Gradle Nature</strong>.</p>

<p><img src="../assets/test/integration_to_gradle.png" alt="" /></p>

<p>Note: at this point, you should see the errors disappear from the project.</p>

<p><strong>15.</strong> Follow <strong>Step 12</strong> to create a <strong>new Java Project</strong>.</p>

<p><strong>16.</strong> In the New Java Project dialog name the project <strong>OrderService</strong>, uncheck the <strong>Use default location</strong>, choose the <strong>OrderService</strong> folder located in <code class="highlighter-rouge">src/Backend/</code> of the PartsUnlimitedMRP repository, and click <strong>Finish</strong>.</p>

<p><img src="../assets/test/new_order_service.png" alt="" /></p>

<p><strong>17.</strong> In the Package Explorer window, <strong>right-click on OrderService</strong> and then select <strong>Configure -&gt; Add Gradle Nature</strong>.</p>

<p><strong>18.</strong> Follow <strong>Step 12</strong> again to create a <strong>new Java Project</strong>.</p>

<p><strong>19.</strong> In the New Java Project dialog name the project <strong>Clients</strong>, uncheck the <strong>Use default location</strong>, choose the <strong>Clients</strong> folder located in <code class="highlighter-rouge">src/</code> of the PartsUnlimitedMRP repository, and click <strong>Finish</strong>.</p>

<p><img src="../assets/test/new_clients.png" alt="" /></p>

<p><strong>20.</strong> In the Package Explorer window, <strong>right-click on Clients</strong> and then select <strong>Configure -&gt; Add Gradle Nature</strong>.</p>

<p>You should now have 3 projects in Eclipse that are all Gradle projects (signified by the <code class="highlighter-rouge">G</code> in the glyph of the projects in the Package Explorer window).</p>

<p><img src="../assets/test/gradle_projects.png" alt="" /></p>

<p><strong>21.</strong> In Eclipse’s menu select <strong>Window -&gt; Show View -&gt; Other…</strong></p>

<p><img src="../assets/test/other_view.png" alt="" /></p>

<p><strong>22.</strong> Type <code class="highlighter-rouge">gradle</code> in the filter box, and select “Gradle Tasks.”</p>

<p><img src="../assets/test/show_gradle_view.png" alt="" /></p>

<p>You can now select one of the three projects that were created, and be able to view all of the Gradle tasks in each on via the Gradle Tasks window.</p>

<p><img src="../assets/test/integration_gradle_tasks.png" alt="" /></p>

<p>The development environment is now set up, and you should be ready to make write some automated tests. Go ahead and look over the different tasks - you may even want to try out the <code class="highlighter-rouge">build</code> task.</p>

<p><img src="../assets/test/gradle_build_console.png" alt="" /></p>

<h3 id="add-junit-tests-to-parts-unlimited-mrp-app">2. Add JUnit tests to Parts Unlimited MRP App</h3>

<p>This task will focus on creating a unit test to test a part of the Parts Unlimited App.</p>

<p><strong>1.</strong> There are already many JUnit tests that exist within the various projects of the Parts Unlimited MRP App. <strong>Open up the file</strong> in the <strong>OrderService</strong> Eclipse project located here:</p>

<div class="highlighter-rouge"><pre class="highlight"><code> src/test/java/smpl.ordering.controllers/CatalogControllerTest.java
</code></pre>
</div>

<p><img src="../assets/test/open_catalog_tests.png" alt="" /></p>

<p><strong>2.</strong> Lets go ahead and run these tests. In the menu select <strong>Run -&gt; Run As -&gt; JUnit Test</strong>.</p>

<p><img src="../assets/test/run_default_tests.png" alt="" /></p>

<p>This should open up the JUnit window and give you a summary of the test run.</p>

<p><img src="../assets/test/default_test_run.png" alt="" /></p>

<p><strong>3.</strong> Paste the following code on <strong>line 31</strong> of the <code class="highlighter-rouge">CatalogControllerTest.java</code> file :</p>

<div class="highlighter-rouge"><pre class="highlight"><code>@Test
public void testAddCatalogItems() throws Exception
{
	ResponseEntity&lt;List&lt;CatalogItem&gt;&gt; oldItems = controller.getCatalogItems();
	int sizeBeforeAdds = 0;
	if (oldItems.getBody() != null)
	{
    	sizeBeforeAdds = oldItems.getBody().size();
	}
	
	ResponseEntity&lt;CatalogItem&gt; response = 
			controller.addCatalogItem(new CatalogItem("ACC-0123", "Storage", 15.75, 5, 2));
	assertNotNull(response);
	assertEquals(HttpStatus.CREATED, response.getStatusCode());
	
	response = 
			controller.addCatalogItem(new CatalogItem("ACC-0124", "Storage", 11.25, 7, 6));
	assertNotNull(response);
	assertEquals(HttpStatus.CREATED, response.getStatusCode());
	
	ResponseEntity&lt;List&lt;CatalogItem&gt;&gt; newItems = controller.getCatalogItems();
	int sizeAfterAdds = newItems.getBody().size();
	
	assertEquals(sizeBeforeAdds + 2, sizeAfterAdds);
}
</code></pre>
</div>

<p>The final result should look something like this:</p>

<p><img src="../assets/test/new_test_method.png" alt="" /></p>

<p><strong>4.</strong> Go ahead and re-run the JUnit tests from the menu <strong>Run -&gt; Run As -&gt; JUnit Test</strong>.</p>

<p><img src="../assets/test/new_test_result.png" alt="" /></p>

<p>You should now be able to see that the test in the JUnit Window.</p>

<h3 id="run-the-automated-tests-in-an-automated-build">3. Run the automated tests in an automated build</h3>

<p>Now that we have the automated tests written, and successfully running, it’s important we push the new tests to the shared repository. This will allow other team members to benefit from the automated test and give the automated build more verification that our code is working as expected.</p>

<p><strong>1.</strong> In Eclipse, <strong>switch to the Git perspective</strong> in the top right of the screen.</p>

<p><img src="../assets/test/switch_to_git_perspective.png" alt="" /></p>

<p><strong>2.</strong> In the Git Repositories window, select the <code class="highlighter-rouge">PartsUnlimitedMRP</code> git repository.</p>

<p><img src="../assets/test/select_pum_repo.png" alt="" /></p>

<p><strong>3.</strong> Select the <strong>Git Staging</strong> window. <strong>Highlight</strong> all of the Unstaged Changes and <strong>drag and drop them into Stage Changes</strong>.</p>

<p><img src="../assets/test/stage_changes.png" alt="" /></p>

<p>Note: Three <code class="highlighter-rouge">.gitignore</code> flies have changed. Eclipse automatically added the <code class="highlighter-rouge">bin/</code> folder here, so any binaries that are built locally will not be tracked. You can choose not to stage these.</p>

<p><strong>4.</strong> Add the following as a commit message, and then click <strong>Commit and Push</strong>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Add new test to CatalogControllerTest.java
</code></pre>
</div>

<p><img src="../assets/test/commit_and_push.png" alt="" /></p>

<p>The Push Results window should pop up after you have successfully pushed:</p>

<p><img src="../assets/test/push_results.png" alt="" /></p>

<p><strong>5.</strong> Navigate to the <strong>BUILD</strong> hub in your Visual Studio Team Services Team Project, and then click the <strong>Queued</strong> tab. You should see that your continuous integration build was triggered, and is running.</p>

<p>Once the build is done, <strong>open up the build summary page</strong> by double-clicking on it.</p>

<p><strong>7.</strong> On the build summary page, note that 54 tests have run successfully. Click on the <strong>Tests</strong> tab to view the list of automated tests.</p>

<p><img src="../assets/test/build_test_summary.png" alt="" /></p>

<p><strong>8.</strong> In the <strong>Tests</strong> tab, select the <strong>Passed</strong> outcome in the dropdown area, and you should now see that your new automated test is a part of the Continuous Integration Build.</p>

<p><img src="../assets/test/build_test_results.png" alt="" /></p>

<h2 id="next-steps">Next steps</h2>

<p>In this lab, you set up your development environment to work with Gradle, you added a new JUnit test to the Parts Unlimited MRP App, and you were able to see that reflected in the automated build process.</p>

<ul>
  <li>
    <p><a href="https://github.com/Microsoft/PartsUnlimitedMRP/tree/master/docs/HOL_Continuous-Integration">HOL Parts Unlimited MRP Continuous Integration</a></p>
  </li>
  <li>
    <p><a href="https://github.com/Microsoft/PartsUnlimitedMRP/tree/master/docs/HOL_Continuous-Deployment">HOL Parts Unlimited MRP Continuous Deployment</a></p>
  </li>
  <li>
    <p><a href="https://github.com/Microsoft/PartsUnlimitedMRP/tree/master/docs/HOL_Application-Performance-Monitoring">HOL Parts Unlimited MRP Application Performance Monitoring</a></p>
  </li>
</ul>

<h1 id="continuous-feedbacks">Continuous Feedbacks</h1>

<h4 id="issues--questions-about-this-hol-">Issues / Questions about this HOL ??</h4>

<p><a href="https://github.com/Microsoft/PartsUnlimitedMRP/issues">If you are encountering some issues or questions during this Hands on Labs, please open an issue by clicking here</a></p>

<p>Thanks</p>


                    </div>
                
            </div>

            

            <div class="row">
                <div id="footer" class="col-sm-12">
                    Documentation for <a href="https://github.com/Microsoft/PartsUnlimitedMRP">PartsUnlimitedMRP</a>

                </div>
            </div>
        </div>

        <script>
            function orderNav() {
                var list,
                    section,
                    header,
                    sections = [],
                    lists = {},
                    headers = {};

                var navUl = document.querySelectorAll('#navigation ul')[0],
                    navLis = document.querySelectorAll('#navigation ul li');

                if (!navUl) return;

                for (var i = 0; i < navLis.length; i++) {
                    var order, li = navLis[i];

                    if (li.classList.contains('nav-header')) {
                        section = li.textContent || li.innerText;
                        sections.push(section);
                        headers[section] = li;
                        continue;
                    }

                    if (!lists[section]) {
                        lists[section] = [];
                    }

                    order = parseFloat(li.getAttribute('data-order'))
                    lists[section].push([order, li]);
                }

                for (var i = 0; i < sections.length; i++) {
                    section = sections[i];
                    list = lists[section].sort(function(a, b) {
                        return a[0] - b[0];
                    });

                    if (header = headers[section]) {
                        navUl.appendChild(header);
                    }
                    for (var j = 0; j < list.length; j++) {
                        navUl.appendChild(list[j][1]);
                    }
                }
            }

            if (document.querySelectorAll) orderNav();
        </script>
        
    </body>
</html>
